Description: fix arbitrary code injection via incorrect filtering
Origin: backport, http://bzr.linuxfoundation.org/loggerhead/openprinting/cups-filters/revision/7333
Bug: https://bugs.linuxfoundation.org/show_bug.cgi?id=1265
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780267

Index: cups-filters-1.0.61/utils/cups-browsed.c
===================================================================
--- cups-filters-1.0.61.orig/utils/cups-browsed.c	2014-10-08 07:47:08.000000000 -0400
+++ cups-filters-1.0.61/utils/cups-browsed.c	2015-03-13 07:32:33.007132203 -0400
@@ -633,6 +633,7 @@
 		       str[i] == '.' || str[i] == ','))) {
       /* Letter or number, keep it */
       havedash = 0;
+      str[j] = str[i];
     } else {
       /* Replace all other characters by a single '-' */
       if (havedash == 1)
