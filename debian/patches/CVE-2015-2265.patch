Description: fix arbitrary code injection via incorrect filtering
Origin: backport, http://bzr.linuxfoundation.org/loggerhead/openprinting/cups-filters/revision/7333
Bug: https://bugs.linuxfoundation.org/show_bug.cgi?id=1265
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780267

Index: cups-filters-1.0.52/utils/cups-browsed.c
===================================================================
--- cups-filters-1.0.52.orig/utils/cups-browsed.c	2015-03-13 07:42:42.995231625 -0400
+++ cups-filters-1.0.52/utils/cups-browsed.c	2015-03-13 07:42:42.991231598 -0400
@@ -627,6 +627,7 @@
 		       str[i] == '.' || str[i] == ','))) {
       /* Letter or number, keep it */
       havedash = 0;
+      str[j] = str[i];
     } else {
       /* Replace all other characters by a single '-' */
       if (havedash == 1)
